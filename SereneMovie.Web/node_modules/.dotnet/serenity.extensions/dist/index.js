var ie=Object.defineProperty,Qe=Object.defineProperties,Ye=Object.getOwnPropertyDescriptor,Xe=Object.getOwnPropertyDescriptors;var X=Object.getOwnPropertySymbols;var Te=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable;var Ce=(r,t,e)=>t in r?ie(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,K=(r,t)=>{for(var e in t||(t={}))Te.call(t,e)&&Ce(r,e,t[e]);if(X)for(var e of X(t))Se.call(t,e)&&Ce(r,e,t[e]);return r},ne=(r,t)=>Qe(r,Xe(t)),n=(r,t)=>ie(r,"name",{value:t,configurable:!0});var Ee=(r,t)=>{var e={};for(var s in r)Te.call(r,s)&&t.indexOf(s)<0&&(e[s]=r[s]);if(r!=null&&X)for(var s of X(r))t.indexOf(s)<0&&Se.call(r,s)&&(e[s]=r[s]);return e};var f=(r,t,e,s)=>{for(var o=s>1?void 0:s?Ye(t,e):t,i=r.length-1,u;i>=0;i--)(u=r[i])&&(o=(s?u(t,e,o):u(o))||o);return s&&o&&ie(t,e,o),o};var G=(r,t,e)=>new Promise((s,o)=>{var i=a=>{try{l(e.next(a))}catch(c){o(c)}},u=a=>{try{l(e.throw(a))}catch(c){o(c)}},l=a=>a.done?s(a.value):Promise.resolve(a.value).then(i,u);l((e=e.apply(r,t)).next())});import{PasswordEditor as Ze,PrefixedContext as $e,initFormType as _e}from"@serenity-is/corelib";var T=class T extends $e{constructor(t){if(super(t),!T.init){T.init=!0;var e=Ze;_e(T,["OldPassword",e,"NewPassword",e,"ConfirmPassword",e])}}};n(T,"ChangePasswordForm"),T.formKey="Serenity.Extensions.ChangePasswordRequest";var we=T;import{EmailAddressEditor as et,PrefixedContext as tt,initFormType as rt}from"@serenity-is/corelib";var S=class S extends tt{constructor(t){if(super(t),!S.init){S.init=!0;var e=et;rt(S,["Email",e])}}};n(S,"ForgotPasswordForm"),S.formKey="Serenity.Extensions.ForgotPasswordRequest";var De=S;import{PasswordEditor as st,PrefixedContext as ot,initFormType as it}from"@serenity-is/corelib";var E=class E extends ot{constructor(t){if(super(t),!E.init){E.init=!0;var e=st;it(E,["NewPassword",e,"ConfirmPassword",e])}}};n(E,"ResetPasswordForm"),E.formKey="Serenity.Extensions.ResetPasswordRequest";var Re=E;import{fieldsProxy as nt}from"@serenity-is/corelib";var y=class y{};n(y,"UserPreferenceRow"),y.idProperty="UserPreferenceId",y.nameProperty="Name",y.localTextPrefix="Common.UserPreference",y.deletePermission="",y.insertPermission="",y.readPermission="",y.updatePermission="",y.Fields=nt();var Ie=y;import{serviceRequest as at}from"@serenity-is/corelib";var U;(e=>(e.baseUrl="Extensions/UserPreference",e.Methods={Update:"Extensions/UserPreference/Update",Retrieve:"Extensions/UserPreference/Retrieve"},["Update","Retrieve"].forEach(s=>{e[s]=function(o,i,u){return at(e.baseUrl+"/"+s,o,i,u)}})))(U||(U={}));import{Decorators as vt,DialogTexts as Pt,BaseDialog as Ct,localText as ke}from"@serenity-is/corelib";var pe=Object.keys;function lt(r){return typeof r=="boolean"}n(lt,"isBoolean");function ut(r){return r&&typeof r.nodeType=="number"}n(ut,"isElement");function de(r){return typeof r=="string"}n(de,"isString");function ct(r){return typeof r=="number"}n(ct,"isNumber");function w(r){return typeof r=="object"?r!==null:W(r)}n(w,"isObject");function W(r){return typeof r=="function"}n(W,"isFunction");function pt(r){let{prototype:t}=r;return!!(t&&t.isReactComponent)}n(pt,"isComponentClass");function dt(r){return w(r)&&typeof r.length=="number"&&typeof r.nodeType!="number"}n(dt,"isArrayLike");function le(r,t){if(r)for(let e of pe(r))t(r[e],e)}n(le,"forEach");function mt(r){return w(r)&&"current"in r}n(mt,"isRef");var ft=Symbol.for("jsx-dom:type"),Ae=function(r){return r.ShadowRoot="ShadowRoot",r}(Ae||{});function ht(r){return r!=null&&r[ft]===Ae.ShadowRoot}n(ht,"isShadowRoot");function Oe(r){return!lt(r)&&r!=null}n(Oe,"isVisibleChild");function ue(r){return Array.isArray(r)?r.map(ue).filter(Boolean).join(" "):w(r)?Symbol.iterator in r?ue(Array.from(r)):pe(r).filter(t=>r[t]).join(" "):Oe(r)?""+r:""}n(ue,"className");var he=class he{constructor(t){this.props=t}render(){return null}};n(he,"Component");var ce=he;ce.prototype;function gt(r,t,e){t=ne(K({},t),{children:e});let s=new r(t),o=s.render();return"ref"in t&&me(t.ref,s),o}n(gt,"initComponentClass");function h(r,t){let i=t,{children:e}=i,s=Ee(i,["children"]),o;if(de(r)){if(o=s.namespaceURI?document.createElementNS(s.namespaceURI,r):document.createElement(r),bt(s,o),fe(e,o),o instanceof window.HTMLSelectElement&&s.value!=null)if(s.multiple===!0&&Array.isArray(s.value)){let u=s.value.map(l=>String(l));o.querySelectorAll("option").forEach(l=>l.selected=u.includes(l.value))}else o.value=s.value;me(s.ref,o)}else if(W(r))w(r.defaultProps)&&(s=K(K({},r.defaultProps),s)),o=pt(r)?gt(r,s,e):r(ne(K({},s),{children:e}));else throw new TypeError(`Invalid JSX element type: ${r}`);return o}n(h,"jsx");function me(r,t){mt(r)?r.current=t:W(r)&&r(t)}n(me,"attachRef");function fe(r,t){if(dt(r))yt(r,t);else if(de(r)||ct(r))ae(document.createTextNode(r),t);else if(r===null)ae(document.createComment(""),t);else if(ut(r))ae(r,t);else if(ht(r)){let e=t.attachShadow(r.attr);fe(r.children,e),me(r.ref,e)}}n(fe,"appendChild");function yt(r,t){for(let e of[...r])fe(e,t);return t}n(yt,"appendChildren");function ae(r,t){t instanceof window.HTMLTemplateElement?t.content.appendChild(r):t.appendChild(r)}n(ae,"appendChildToNode");function Le(r,t){t==null||t===!1||(Array.isArray(t)?t.forEach(e=>Le(r,e)):de(t)?r.setAttribute("style",t):w(t)&&le(t,(e,s)=>{s.indexOf("-")===0?r.style.setProperty(s,e):r.style[s]=e}))}n(Le,"style");function xt(r,t,e){switch(r){case"htmlFor":Z(e,"for",t);return;case"dataset":le(t,(s,o)=>{s!=null&&(e.dataset[o]=s)});return;case"innerHTML":case"innerText":case"textContent":Oe(t)&&(e[r]=t);return;case"dangerouslySetInnerHTML":w(t)&&(e.innerHTML=t.__html);return;case"value":if(t==null||e instanceof window.HTMLSelectElement)return;if(e instanceof window.HTMLTextAreaElement){e.value=t;return}break;case"spellCheck":e.spellcheck=t;return;case"class":case"className":W(t)?t(e):Z(e,"class",ue(t));return;case"ref":case"namespaceURI":return;case"style":Le(e,t);return;case"on":case"onCapture":le(t,(s,o)=>{e.addEventListener(o,s,r==="onCapture")});return}if(W(t)){if(r[0]==="o"&&r[1]==="n"){let s=r.toLowerCase(),o=s.endsWith("capture");if(s==="ondoubleclick"?s="ondblclick":o&&s==="ondoubleclickcapture"&&(s="ondblclickcapture"),!o&&e[s]===null)e[s]=t;else if(o)e.addEventListener(s.substring(2,s.length-7),t,!0);else{let i;s in window?i=s.substring(2):i=s[2]+r.slice(3),e.addEventListener(i,t)}}}else w(t)?e[r]=t:t===!0?Z(e,r,""):t!==!1&&t!=null&&Z(e,r,t)}n(xt,"attribute");function Z(r,t,e){r.setAttribute(t,e)}n(Z,"attr");function bt(r,t){for(let e of pe(r))xt(e,r[e],t);return t}n(bt,"attributes");var b=class extends Ct{constructor(e){super(e);this.dialogTitle=ke("Site.BasicProgressDialog.PleaseWait")}get max(){return parseInt(this.byId("ProgressBar").attr("aria-valuemax"),10)}set max(e){this.byId("ProgressBar").attr("aria-valuemax",(e||100).toString())}get value(){return parseInt(this.byId("ProgressBar").attr("aria-valuenow"),10)}set value(e){this.byId("ProgressBar").attr("aria-valuenow",(e||0).toString()).text(e+" / "+this.max).getNode().style.width=(e||0)/(this.max||100)*100+"%"}get title(){return this.dialogTitle}set title(e){this.dialogTitle=e}getDialogButtons(){return[{text:Pt.CancelButton,class:"btn btn-danger",click:()=>{var e,s;this.cancelled=!0,(e=this.domNode.closest(".ui-dialog").querySelectorAll(".ui-dialog-buttonpane .ui-button"))==null||e.forEach(o=>{o.setAttribute("disabled","disabled"),o.style.opacity="0.5"}),this.dialogTitle=((s=this.cancelTitle)==null?void 0:s.trim())||ke("Site.BasicProgressDialog.CancelTitle")}}]}getDialogOptions(){var e=super.getDialogOptions();return e.width=600,e}initDialog(){var s;super.initDialog();var e=(s=this.domNode.closest(".ui-dialog"))==null?void 0:s.querySelector(".ui-dialog-titlebar-close");e&&(e.style.display="none")}renderContents(){let e=this.useIdPrefix();return h("div",{class:"s-DialogContent s-BasicProgressDialogContent",children:[h("div",{id:e.StatusText,class:"status-text"}),h("div",{id:e.Progress,class:"progress",style:"height: 1.5rem",children:h("div",{id:e.ProgressBar,class:"progress-bar","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100})})]})}};n(b,"BasicProgressDialog"),b=f([vt.registerClass("Serenity.Extensions.BasicProgressDialog")],b);import{confirmDialog as Tt,localText as v,notifyError as Fe,notifySuccess as St,notifyWarning as Et,stringFormat as k}from"@serenity-is/corelib";var ge=class ge{createProgressDialog(){this.progressDialog=new b({}),this.progressDialog.dialogOpen(),this.progressDialog.max=this.keys.length,this.progressDialog.value=0}getConfirmationFormat(){return v("Site.BulkServiceAction.ConfirmationFormat")}getConfirmationMessage(t){return k(this.getConfirmationFormat(),t)}confirm(t,e){Tt(this.getConfirmationMessage(t),e)}getNothingToProcessMessage(){return v("Site.BulkServiceAction.NothingToProcess")}nothingToProcess(){Fe(this.getNothingToProcessMessage())}getParallelRequests(){return 1}getBatchSize(){return 1}startParallelExecution(){this.createProgressDialog(),this.successCount=0,this.errorCount=0,this.pendingRequests=0,this.completedRequests=0,this.errorCount=0,this.errorByKey={},this.queue=this.keys.slice(),this.queueIndex=0;for(var t=this.getParallelRequests();t-- >0;)this.executeNextBatch()}serviceCallCleanup(){this.pendingRequests--,this.completedRequests++;var t=v(this.progressDialog.cancelled?"Site.BasicProgressDialog.CancelTitle":"Site.BasicProgressDialog.PleaseWait");t+=" (",this.successCount>0&&(t+=k(v("Site.BulkServiceAction.SuccessCount"),this.successCount)),this.errorCount>0&&(this.successCount>0&&(t+=", "),t+=k(v("Site.BulkServiceAction.ErrorCount"),this.errorCount)),this.progressDialog.title=t+")",this.progressDialog.value=this.successCount+this.errorCount,!this.progressDialog.cancelled&&this.progressDialog.value<this.keys.length?this.executeNextBatch():this.pendingRequests===0&&(this.progressDialog.dialogClose("done"),this.showResults(),this.done&&(this.done(),this.done=null))}executeForBatch(t){}executeNextBatch(){for(var t=this.getBatchSize(),e=[];!(e.length>=t||this.queueIndex>=this.queue.length);)e.push(this.queue[this.queueIndex++]);e.length>0&&(this.pendingRequests++,this.executeForBatch(e))}getAllHadErrorsFormat(){return v("Site.BulkServiceAction.AllHadErrorsFormat")}showAllHadErrors(){Fe(k(this.getAllHadErrorsFormat(),this.errorCount))}getSomeHadErrorsFormat(){return v("Site.BulkServiceAction.SomeHadErrorsFormat")}showSomeHadErrors(){Et(k(this.getSomeHadErrorsFormat(),this.successCount,this.errorCount))}getAllSuccessFormat(){return v("Site.BulkServiceAction.AllSuccessFormat")}showAllSuccess(){St(k(this.getAllSuccessFormat(),this.successCount))}showResults(){if(this.errorCount===0&&this.successCount===0){this.nothingToProcess();return}if(this.errorCount>0&&this.successCount===0){this.showAllHadErrors();return}if(this.errorCount>0){this.showSomeHadErrors();return}this.showAllSuccess()}execute(t){if(this.keys=t,this.keys.length===0){this.nothingToProcess();return}this.confirm(this.keys.length,()=>this.startParallelExecution())}get_successCount(){return this.successCount}set_successCount(t){this.successCount=t}get_errorCount(){return this.errorCount}set_errorCount(t){this.errorCount=t}};n(ge,"BulkServiceAction");var qe=ge;import{deepClone as wt,faIcon as Dt,postToService as Rt}from"@serenity-is/corelib";var Ne;(t=>{function r(e){var s,o;return{hint:(s=e.hint)!=null?s:"Excel",title:(o=e.title)!=null?o:"",cssClass:"export-xlsx-button",icon:Dt("file-excel"),onClick:function(){if(!e.onViewSubmit())return;let i=e.grid;var u=wt(i.getView().params);u.Take=0,u.Skip=0;var l=i.getView().sortBy;l&&(u.Sort=l),u.ExportColumns=[];let a=i.getGrid().getColumns();for(let c of a)u.ExportColumns.push(c.id||c.field);e.editRequest&&(u=e.editRequest(u)),Rt({service:e.service,request:u,target:"_blank"})},separator:e.separator}}t.createToolButton=r,n(r,"createToolButton")})(Ne||(Ne={}));import{Fluent as Be,deepClone as It,formatDate as He,resolveUrl as je,serviceCall as At,stringFormat as Ot}from"@serenity-is/corelib";var Me;(u=>{function r(l,a,c){return l.map(m=>{let d={dataKey:m.id||m.field,title:m.name||""};c&&c[d.dataKey]!=null&&(d.title=c[d.dataKey]);let x={};return(m.cssClass||"").indexOf("align-right")>=0?x.halign="right":(m.cssClass||"").indexOf("align-center")>=0&&(x.halign="center"),a[d.dataKey]=x,d})}n(r,"toAutoTableColumns");function t(l,a,c,m){let d=document.createElement("span"),x=0;return a.map(I=>{var J,Q,Y;let p=[];for(let O=0;O<m.length;O++){var M=m[O],V=l.getFormatter(x,M),A=l.getFormatterContext(x,O);A.item=I,A.value=I[M.field];let g=V?V(A):"";!g||!(g instanceof Node)&&g.indexOf("<")<0&&g.indexOf("&")<0?p.push(g):(Be.empty(d),g instanceof Node?d.appendChild(g):d.innerHTML=g,d.children.length==1&&((J=d.children[0])==null?void 0:J.nodeName)==="SELECT"?p.push((Y=(Q=d.children[0].querySelector("[selected]"))==null?void 0:Q.textContent)!=null?Y:""):d.children.length==1&&Be.isInputLike(d.children[0])?p.push(d.children[0].value):d.children.length==1&&d.children[0].classList.contains(".check-box")?p.push(d.children[0].classList.contains("checked")?"X":""):p.push(d.textContent||""))}return x++,p})}n(t,"toAutoTableData");function e(l){var a=l.grid;if(l.onViewSubmit()){var c=It(a.view.params);c.Take=0,c.Skip=0;var m=a.view.sortBy;m!=null&&(c.Sort=m);var d=a.slickGrid.getColumns();d=d.filter(I=>I.id!=="__select__"),c.IncludeColumns=[];for(var x of d)c.IncludeColumns.push(x.id||x.field);At({url:a.view.url,request:c,onSuccess:I=>i(()=>{let p=new jsPDF("l","pt"),M=d,V={},A=r(M,V,l.columnTitles);var J=A.map(C=>C.dataKey);let Q=I.Entities||[],Y=t(a.slickGrid,Q,J,M);p.setFontSize(l.titleFontSize||10),p.setFont("helvetica","bold");let O=l.reportTitle||a.getTitle()||"Report";p.autoTableText(O,p.internal.pageSize.width/2,l.titleTop||25,{halign:"center"});var g="{{T}}";let Pe=l.pageNumbers==null||l.pageNumbers;var L=Object.assign({margin:{top:25,left:25,right:25,bottom:Pe?25:30},startY:60,styles:{fontSize:8,overflow:"linebreak",cellPadding:2,valign:"middle"},columnStyles:V},l.tableOptions),ee,te;if(Pe&&(ee=n(function(C){var oe=C.pageCount;typeof p.putTotalPages=="function"&&(oe=oe+" / "+g),p.autoTableText(oe,p.internal.pageSize.width/2,p.internal.pageSize.height-L.margin.bottom,{halign:"center"})},"footer")),(l.printDateTimeHeader==null||l.printDateTimeHeader)&&(te=n(function(C){p.setFont("helvetica","normal"),p.setFontSize(8),p.autoTableText(He(new Date,"dd-MM-yyyy HH:mm"),p.internal.pageSize.width-L.margin.right,13,{halign:"right"})},"header")),L.didDrawPage=C=>{te&&te(C),ee&&ee(C)},L.head=[A],L.body=Y,p.autoTable(L),typeof p.putTotalPages=="function"&&p.putTotalPages(g),!l.output||l.output=="file"){var re=l.fileName||l.reportTitle||"{0}_{1}.pdf";re=Ot(re,a.getTitle()||"report",He(new Date,"yyyyMMdd_HHmm")),p.save(re);return}l.autoPrint&&p.autoPrint();var se=l.output;se=="newwindow",se="dataurlnewwindow",p.output(se)})})}}u.exportToPdf=e,n(e,"exportToPdf");function s(l){return{title:l.title||"",hint:l.hint||"PDF",cssClass:"export-pdf-button",onClick:()=>e(l),separator:l.separator}}u.createToolButton=s,n(s,"createToolButton");function o(l){if(typeof jsPDF!="undefined")return l();var a=document.getElementById("jsPDFScript");if(a)return l();a=document.createElement("script"),a.type="text/javascript",a.async=!1,a.id="jsPDFScript",a.addEventListener("load",()=>{typeof jsPDF=="undefined"&&typeof jspdf!="undefined"&&(window.jsPDF=jspdf.jsPDF),l()}),a.src=je("~/Serenity.Assets/Scripts/jspdf.min.js"),document.head.append(a)}n(o,"includeJsPDF");function i(l){o(()=>{if(typeof jsPDF=="undefined"||typeof jsPDF.API=="undefined"||typeof jsPDF.API.autoTable!="undefined")return l();var a=document.querySelector("#jsPDFAutoTableScript");if(a)return l();a=document.createElement("script"),a.async=!1,a.type="text/javascript",a.id="jsPDFAutoTableScript",a.addEventListener("load",()=>{l()}),a.src=je("~/Serenity.Assets/Scripts/jspdf.plugin.autotable.min.js"),document.head.append(a)})}n(i,"includeAutoTable")})(Me||(Me={}));import{Decorators as Lt,EnumTypeRegistry as kt,htmlEncode as ye,localText as Ft,tryGetText as qt}from"@serenity-is/corelib";var F=class{constructor(t={}){this.props=t;var e,s,o;(e=this.props)!=null||(this.props={}),(o=(s=this.props).allowClear)!=null||(s.allowClear=!0)}format(t){var u;var e=kt.get((u=this.props.enumKey)!=null?u:"EnumKeyOptionNotSpecified!"),s="<select>";this.props.allowClear&&(s+='<option value="">',s+=ye(this.props.emptyItemText||Ft("Controls.SelectEditor.EmptyItemText")),s+="</option>");for(var o of Object.keys(e).filter(l=>!isNaN(parseInt(l,10)))){s+='<option value="'+ye(o)+'"',o==t.value&&(s+=" selected");var i=e[o];s+=">",s+=ye(qt("Enums."+this.props.enumKey+"."+i)||i),s+="</option>"}return s+="</select>",s}get enumKey(){return this.props.enumKey}set enumKey(t){this.props.enumKey=t}get allowClear(){return this.props.allowClear}set allowClear(t){this.props.allowClear=t}get emptyItemText(){return this.props.emptyItemText}set emptyItemText(t){this.props.emptyItemText=t}};n(F,"EnumSelectFormatter"),F=f([Lt.registerFormatter("Serenity.Extensions.EnumSelectFormatter")],F);import{Decorators as Nt,htmlEncode as Bt,toSingleLine as Ht}from"@serenity-is/corelib";var D=class{format(t){return D.formatValue(t.value)}static formatValue(t){var e=document.createElement("div");return e.innerHTML=t!=null?t:"",Bt(Ht(e.textContent))}};n(D,"SingleLineTextFormatter"),D=f([Nt.registerFormatter("Serenity.Extensions.SingleLineTextFormatter")],D);import{Decorators as xe,EntityGrid as jt,IGetEditValue as Mt,ISetEditValue as Vt,deepClone as $,indexOf as Kt}from"@serenity-is/corelib";var q=class extends jt{constructor(e){super(e);this.nextId=1}getIdProperty(){return"__id"}id(e){return e[this.getIdProperty()]}getNextId(){return"`"+this.nextId++}setNewId(e){e[this.getIdProperty()]=this.getNextId()}save(e,s){var o=e.request,i=$(o.Entity),u=this.id(i);if(u==null&&(i[this.getIdProperty()]=this.getNextId()),!!this.validateEntity(i,u)){var l=this.view.getItems().slice();if(u==null)l.push(i);else{var a=Kt(l,c=>this.id(c)===u);l[a]=$({},l[a],i)}this.setEntities(l),s({})}}deleteEntity(e){return this.view.deleteItem(e),!0}validateEntity(e,s){return!0}setEntities(e){this.view.setItems(e,!0)}getNewEntity(){return{}}getButtons(){var e=super.getButtons(),s=e.find(o=>o.action==="add");return s&&(s.onClick=()=>{this.createEntityDialog(this.getItemType(),o=>{var i=o;i.onSave=(u,l)=>this.save(u,l),this.transferDialogReadOnly(i),i.loadEntityAndOpenDialog(this.getNewEntity())})}),e.filter(o=>o.action!=="refresh")}editItem(e){var s=e,o=this.view.getItemById(s);this.createEntityDialog(this.getItemType(),i=>{var u=i;u.onDelete=(l,a)=>{this.deleteEntity(s)&&a({})},this.transferDialogReadOnly(u),u.onSave=(l,a)=>this.save(l,a),u.loadEntityAndOpenDialog(o)})}getEditValue(e,s){s[e.name]=this.value}setEditValue(e,s){this.value=e[s.name]}get value(){var e=this.getIdProperty();return this.view.getItems().map(s=>{var o=$(s),i=o[e];return i&&i.toString().charAt(0)=="`"&&delete o[e],o})}set value(e){var s=this.getIdProperty();this.view.setItems((e||[]).map(o=>{var i=$(o);return i[s]==null&&(i[s]=this.getNextId()),i}),!0)}getGridCanLoad(){return!1}usePager(){return!1}getInitialTitle(){return null}createQuickSearchInput(){}};n(q,"GridEditorBase"),q=f([xe.registerClass("Serenity.Extensions.GridEditorBase",[Mt,Vt]),xe.editor(),xe.element("<div/>")],q);import{Decorators as Ve,EntityDialog as Gt}from"@serenity-is/corelib";var N=class extends Gt{getIdProperty(){return"__id"}destroy(){this.onSave=null,this.onDelete=null,super.destroy()}updateInterface(){super.updateInterface(),this.applyChangesButton&&this.applyChangesButton.hide()}saveHandler(e,s){this.onSave&&this.onSave(e,s)}deleteHandler(e,s){this.onDelete&&this.onDelete(e,s)}};n(N,"GridEditorDialog"),N=f([Ve.registerClass("Serenity.Extensions.GridEditorDialog"),Ve.panel(!1)],N);import{Decorators as Wt,BaseDialog as zt,PropertyGrid as Jt,faIcon as Qt,resolveUrl as Yt,serviceCall as Xt}from"@serenity-is/corelib";import{postToUrl as Ut}from"@serenity-is/corelib";var _;(e=>{function r(s){var o,i;return{title:(o=s.title)!=null?o:"Report",cssClass:(i=s.cssClass)!=null?i:"print-button",icon:s.icon,onClick:()=>{e.execute(s)}}}e.createToolButton=r,n(r,"createToolButton");function t(s){var i,u;var o=s.getParams?s.getParams():s.params;Ut({url:"~/Serenity.Extensions/Report/"+(s.download?"Download":"Render"),params:{key:s.reportKey,ext:(i=s.extension)!=null?i:"pdf",opt:o?JSON.stringify(o):""},target:(u=s.target)!=null?u:"_blank"})}e.execute=t,n(t,"execute")})(_||(_={}));var P=class extends zt{constructor(e){super(e);this.updateInterface(),this.loadReport(this.options.reportKey)}getDialogButtons(){return null}createPropertyGrid(){this.propertyGrid&&this.byId("PropertyGrid").empty().class(""),this.propertyGrid=new Jt({element:this.byId("PropertyGrid"),idPrefix:this.idPrefix,useCategories:!0,items:this.report.Properties}).init()}loadReport(e){Xt({url:Yt("~/Serenity.Extensions/Report/Retrieve"),request:{ReportKey:e},onSuccess:s=>{this.report=s,this.dialogTitle=this.report.Title,this.createPropertyGrid(),this.propertyGrid.load(this.report.InitialSettings||{}),this.updateInterface(),this.dialogOpen()}})}updateInterface(){this.toolbar.findButton("print-preview-button").toggle(this.report&&!this.report.IsDataOnlyReport&&!this.report.IsExternalReport),this.toolbar.findButton("run-button").toggle(this.report&&this.report.IsExternalReport),this.toolbar.findButton("export-pdf-button").toggle(this.report&&!this.report.IsDataOnlyReport&&!this.report.IsExternalReport),this.toolbar.findButton("export-xlsx-button").toggle(this.report&&this.report.IsDataOnlyReport&&!this.report.IsExternalReport)}executeReport(e,s,o){if(this.validateForm()){var i={};this.propertyGrid.save(i),_.execute({download:o,reportKey:this.report.ReportKey,extension:s,target:e,params:i})}}getToolbarButtons(){return[{title:"Preview",cssClass:"print-preview-button",onClick:()=>this.executeReport("_blank",null,!1)},{title:"Run",cssClass:"run-button",icon:Qt("print","blue"),onClick:()=>this.executeReport("_blank",null,!1)},{title:"PDF",cssClass:"export-pdf-button",onClick:()=>this.executeReport("_blank","pdf",!0)},{title:"Excel",cssClass:"export-xlsx-button",onClick:()=>this.executeReport("_blank","xlsx",!0)}]}renderContents(){let e=this.useIdPrefix();return h("div",{class:"s-DialogContent",children:[h("div",{id:e.Toolbar,class:"s-DialogToolbar"}),h("div",{class:"s-Form",children:h("form",{id:e.Form,action:"",children:h("div",{id:e.PropertyGrid})})})]})}};n(P,"ReportDialog"),P=f([Wt.registerClass("Serenity.Extensions.ReportDialog")],P);import{Decorators as Zt,Fluent as $t,QuickSearchInput as _t,Widget as er,stripDiacritics as Ke}from"@serenity-is/corelib";var B=class extends er{constructor(t){super(t),$t.on(this.domNode,"click",".report-link",this.reportLinkClick.bind(this)),new _t({element:this.domNode.querySelector(".s-QuickSearchBar input"),onSearch:(e,s,o)=>{this.updateMatchFlags(s),o(!0)}})}updateMatchFlags(t){var e=this.domNode.querySelectorAll(".report-list li");if(e.forEach(a=>a.classList.remove("non-match")),t=t==null?void 0:t.trim(),!t)return;t=Ke(t).toUpperCase();var s=Array.from(e).filter(a=>a.classList.contains("report-item"));s.forEach(function(a){var m;var c=Ke(((m=a.textContent)!=null?m:"").toUpperCase());c.indexOf(t)<0&&a.classList.add("non-match")});function o(a,c){let m=[];for(;(a=a.parentNode)&&a!==document;)(!c||a.matches(c))&&m.push(a);return m}n(o,"parents");var i=s.filter(a=>!a.classList.contains("non-match")),u=[...i];i.forEach(a=>u.push(...o(a,"li"))),u=u.filter((a,c)=>u.indexOf(a)===c),u.forEach(a=>{a.querySelectorAll(":scope [data-bs-toggle]:not([aria-expanded=true])").forEach(c=>{c.setAttribute("aria-expanded","true"),c.classList.remove("collapsed")}),a.parentElement&&a.parentElement.classList.contains("collapse")&&!a.parentElement.classList.contains("show")&&a.parentElement.classList.add("show")});var l=Array.from(e).filter(a=>u.indexOf(a)<0);l.forEach(a=>a.classList.add("non-match"))}reportLinkClick(t){t.preventDefault(),new P({reportKey:t.target.getAttribute("data-key")}).dialogOpen()}};n(B,"ReportPage"),B=f([Zt.registerClass("Serenity.Extensions.ReportPage")],B);var be=class be{getItem(t){return G(this,null,function*(){return(yield Promise.resolve(U.Retrieve({PreferenceType:"UserPreferenceStorage",Name:t}))).Value})}setItem(t,e){return G(this,null,function*(){return Promise.resolve(U.Update({PreferenceType:"UserPreferenceStorage",Name:t,Value:e}))})}};n(be,"UserPreferenceStorage");var Ge=be;import{Dialog as tr,Fluent as ve,confirmDialog as rr,isArrayLike as sr,localText as Ue}from"@serenity-is/corelib";var We;(t=>{function r(e,s){var l;var o=sr(e)?e[0]:e;if(!o)return;var i=tr.getInstance(o);i==null||i.onClose((a,c)=>{(i==null?void 0:i.result)==="save-and-close"||(i==null?void 0:i.result)==="save"||(i==null?void 0:i.result)==="delete"||(i==null?void 0:i.result)==="done"||o.dataset.ackuntil&&new Date().getTime()<parseInt(o.dataset.ackuntil,10)||!s()||(c.preventDefault(),c.stopImmediatePropagation(),rr(Ue("Site.Dialogs.PendingChangesConfirmation"),()=>{var m;o.dataset.ackuntil=""+new Date().getTime()+1e3,(m=o.querySelector("div.save-and-close-button"))==null||m.click()},{onNo:function(){o.dataset.ackuntil=""+new Date().getTime()+1e3,i==null||i.close(i==null?void 0:i.result)}}))},!0);function u(){if(!(!ve.isVisibleLike(o)||!s()))return Ue("Site.Dialogs.PendingChangesUnloadWarning")}n(u,"beforeUnload"),ve.on(window,"beforeunload",u),(l=i==null?void 0:i.onClose)==null||l.call(i,()=>ve.off(window,"beforeunload",u))}t.pendingChangesConfirmation=r,n(r,"pendingChangesConfirmation")})(We||(We={}));import{Decorators as or,PropertyDialog as ir,cancelDialogButton as nr,getTypeFullName as ar,okDialogButton as lr,toggleClass as ur}from"@serenity-is/corelib";var R=class extends ir{constructor(t){if(super(t),this.options.cssClass&&ur(this.domNode,this.options.cssClass),this.options.message){var e=document.createElement("div");e.classList.add("message"),this.byId("PropertyGrid").prepend(e),this.options.isHtml?e.innerHTML=this.options.message:e.textContent=this.options.message}this.dialogTitle=this.options.title||"Prompt"}getDialogButtons(){return[lr({click:t=>{if(!this.validateForm()){t.preventDefault();return}this.options.validateValue!=null&&!this.options.validateValue(this.value)&&t.preventDefault()}}),nr()]}loadInitialEntity(){this.value=this.options.value}getPropertyItems(){var t;return[{name:"Value",editorType:typeof this.options.editorType=="function"?ar(this.options.editorType):this.options.editorType||"String",required:(t=this.options.required)!=null?t:!0,editorParams:this.options.editorOptions}]}get value(){return this.getSaveEntity().Value}set value(t){this.propertyGrid.load({Value:t})}static prompt(t,e,s,o){new R({title:t,message:e,value:s,validateValue:i=>o(i)}).dialogOpen()}};n(R,"PromptDialog"),R=f([or.registerClass("Serenity.Extensions.PromptDialog")],R);import{Decorators as cr,EntityGrid as pr}from"@serenity-is/corelib";import{RowSelectionModel as dr}from"@serenity-is/sleekgrid";var H=class extends pr{getSlickOptions(){var t=super.getSlickOptions();return t.enableTextSelectionOnCells=!0,t.selectedCellCssClass="slick-row-selected",t.enableCellNavigation=!0,t}createSlickGrid(){var t=super.createSlickGrid();return t.setSelectionModel(new dr),t}};n(H,"SelectableEntityGrid"),H=f([cr.registerClass("Serenity.Extensions.SelectableEntityGrid")],H);import{Decorators as ze,ISetEditValue as mr,Widget as fr,localText as hr}from"@serenity-is/corelib";var j=class extends fr{constructor(e){var s;super(e);if(this.options.hideLabel){let o=(s=this.domNode.closest(".field"))==null?void 0:s.querySelector(".caption");o&&(o.style.display="none")}this.updateElementContent()}updateElementContent(){var s;var e=(s=this.options.text)!=null?s:this.value;this.options.isLocalText&&(e=hr(e)),this.options.isHtml?this.domNode.innerHTML=e:this.domNode.textContent=e}setEditValue(e,s){var o;this.options.text==null&&(this.value=(o=this.options.text)!=null?o:e[s.name],this.updateElementContent())}};n(j,"StaticTextBlock"),j=f([ze.element("<div/>"),ze.registerEditor("Serenity.Extensions.StaticTextBlock",[mr])],j);import{getRemoteDataAsync as gr,localText as z,stringFormat as Je}from"@serenity-is/corelib";function yr(){return G(this,null,function*(){return yield gr("PasswordStrengthRules")})}n(yr,"getPasswordStrengthRules");function Uo(r,t){yr().then(e=>{r.addValidationRule(()=>{if(r.value.length<e.MinPasswordLength)return Je(z("Validation.MinRequiredPasswordLength"),e.MinPasswordLength)},t),e.RequireDigit&&r.addValidationRule(()=>{if(!/[0-9]/.test(r.value))return Je(z("Validation.PasswordStrengthRequireDigit"))},t),e.RequireLowercase&&r.addValidationRule(()=>{if(!/[a-z\p{Ll}]/u.test(r.value))return z("Validation.PasswordStrengthRequireDigit")},t),e.RequireUppercase&&r.addValidationRule(()=>{if(!/[A-Z\p{Lu}]/u.test(r.value))return z("Validation.PasswordStrengthRequireUppercase")},t),e.RequireNonAlphanumeric&&r.addValidationRule(()=>{if(!/[^\s\p{L}]/u.test(r.value))return z("Validation.PasswordStrengthRequireNonAlphanumeric")},t)})}n(Uo,"addPasswordStrengthValidation");export{b as BasicProgressDialog,qe as BulkServiceAction,we as ChangePasswordForm,We as DialogUtils,F as EnumSelectFormatter,Ne as ExcelExportHelper,De as ForgotPasswordForm,q as GridEditorBase,N as GridEditorDialog,Me as PdfExportHelper,R as PromptDialog,P as ReportDialog,_ as ReportHelper,B as ReportPage,Re as ResetPasswordForm,H as SelectableEntityGrid,D as SingleLineTextFormatter,j as StaticTextBlock,Ie as UserPreferenceRow,U as UserPreferenceService,Ge as UserPreferenceStorage,Uo as addPasswordStrengthValidation,yr as getPasswordStrengthRules};
//# sourceMappingURL=index.js.map
